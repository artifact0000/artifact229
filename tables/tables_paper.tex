

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% fastest implementations - as in the paper
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\setlength{\tabcolsep}{3pt}
\begin{table}[H]
    \caption{Performance: 11700K - fastest implementations.}
    \label{tab:results:all:11700K:avx2}
  \begin{tabular}{lllrrrrr}
  \toprule
    Primitive
 & Impl. & Op.          & plain & +SSBD & +SSBD+v1 & +SSBD+v1+RSB & increase \% \\

    \multirow{6}{*}{ChaCha20}
 &  \multirow{6}{*}{avx2}
         & 128\,B       & 344
                        & 344
                        & 398
                        & 398
                        & 15.70 \\

 &       & 128\,B xor   & 350
                        & 350
                        & 402
                        & 400
                        & 14.29 \\

 &       & 1\,KiB       & 1198
                        & 1202
                        & 1244
                        & 1246
                        & 4.01 \\

 &       & 1\,KiB xor   & 1208
                        & 1212
                        & 1248
                        & 1250
                        & 3.48 \\

 &       & 16\,KiB      & 19040
                        & 19052
                        & 19066
                        & 19068
                        & 0.15 \\

 &       & 16\,KiB xor  & 19070
                        & 19086
                        & 19096
                        & 19110
                        & 0.21 \\

     \midrule
    \multirow{6}{*}{Poly1305}
 &  \multirow{6}{*}{avx2}

        & 128\,B        & 138
                        & 142
                        & 182
                        & 180
                        & 30.43 \\

 &      & 128\,B verif  & 142
                        & 146
                        & 180
                        & 178
                        & 25.35 \\

 &      & 1\,KiB        & 670
                        & 672
                        & 720
                        & 718
                        & 7.16 \\

 &      & 1\,KiB verif  & 674
                        & 676
                        & 726
                        & 724
                        & 7.42 \\

 &      & 16\,KiB       & 8942
                        & 8948
                        & 8990
                        & 8986
                        & 0.49 \\

 &      & 16\,KiB verif & 8942
                        & 8984
                        & 8984
                        & 8984
                        & 0.47 \\

      \midrule
    \multirow{6}{*}{XSalsa20Poly1305}
 &  \multirow{6}{*}{avx2}
        & 128\,B        & 1206
                        & 1212
                        & 1250
                        & 1246
                        & 3.32 \\

 &      & 128\,B open   & 1964
                        & 1970
                        & 2044
                        & 2046
                        & 4.18 \\

 &      & 1\,KiB        & 3140
                        & 3142
                        & 3190
                        & 3188
                        & 1.53 \\

 &      & 1\,KiB open   & 3900
                        & 3904
                        & 3988
                        & 3988
                        & 2.26 \\

 &      & 16\,KiB       & 32598
                        & 32574
                        & 32604
                        & 32602
                        & 0.01 \\

 &      & 16\,KiB open  & 33292
                        & 33274
                        & 33358
                        & 33362
                        & 0.21 \\

      \midrule
    \multirow{4}{*}{SHAKE256}
 &  \multirow{4}{*}{avx2}
        &  128\,B \textleftarrow\, 128\,B
                        & 1206
                        & 1324
                        & 1390
                        & 1390
                        & 15.26 \\

 &      &  256\,B \textleftarrow\, 128\,B
                        & 2334
                        & 2450
                        & 2534
                        & 2546
                        & 9.08 \\


 &      &  512\,B \textleftarrow\, 128\,B
                        & 4588
                        & 4700
                        & 4796
                        & 4826
                        & 5.19 \\


 &      &  1\,KiB \textleftarrow\, 128\,B
                        & 9102
                        & 9216
                        & 9400
                        & 9384
                        & 3.10 \\

      \midrule
    \multirow{1}{*}{X25519}
 & mulx & smult         & 102848
                        & 104150
                        & 104424
                        & 104428
                        & 1.54 \\

      \midrule
    \multirow{3}{*}{Kyber512}
 &  \multirow{3}{*}{avx2}
        & keypair       & 27676
                        & 28106
                        & 28040
                        & 28090
                        & 1.50 \\

 &      & enc           & 37050
                        & 38332
                        & 38876
                        & 38792
                        & 4.70 \\

 &      & dec           & 29302
                        & 30444
                        & 30590
                        & 30714
                        & 4.82 \\

      \midrule
    \multirow{3}{*}{Kyber768}
 &  \multirow{3}{*}{avx2}
        & keypair       & 43432
                        & 45708
                        & 45860
                        & 46548
                        & 7.17 \\

 &      & enc           & 57006
                        & 59316
                        & 60028
                        & 60674
                        & 6.43 \\

 &      & dec           & 46138
                        & 48418
                        & 48532
                        & 49294
                        & 6.84 \\
  \bottomrule
  \end{tabular}
\end{table}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%  fastest implementations - step by step overhead
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\setlength{\tabcolsep}{3pt}
\begin{table}[H]
    \caption{Performance: 11700K - fastest implementations - step by step overhead.}
    \label{tab:results:all:step:11700K:avx2}
  \begin{tabular}{lllrrrrrrrr}
  \toprule
    Primitive
 & Impl. & Op.          & plain & +SSBD & \% & +SSBD+v1 & \% & +SSBD+v1+RSB & \% & increase \% \\

    \multirow{6}{*}{ChaCha20}
 &  \multirow{6}{*}{avx2}
        & 128\,B        & 344
                        & 344
                        & 0.00
                        & 398
                        & 15.70
                        & 398
                        & 0.00
                        & 15.70 \\

 &      & 128\,B xor    & 350
                        & 350
                        & 0.00
                        & 402
                        & 14.86
                        & 400
                        & -0.50
                        & 14.29 \\

 &      & 1\,KiB        & 1198
                        & 1202
                        & 0.33
                        & 1244
                        & 3.49
                        & 1246
                        & 0.16
                        & 4.01 \\

 &      & 1\,KiB xor    & 1208
                        & 1212
                        & 0.33
                        & 1248
                        & 2.97
                        & 1250
                        & 0.16
                        & 3.48 \\

 &      & 16\,KiB       & 19040
                        & 19052
                        & 0.06
                        & 19066
                        & 0.07
                        & 19068
                        & 0.01
                        & 0.15 \\

 &      & 16\,KiB xor   & 19070
                        & 19086
                        & 0.08
                        & 19096
                        & 0.05
                        & 19110
                        & 0.07
                        & 0.21 \\

     \midrule
    \multirow{6}{*}{Poly1305}
 &  \multirow{6}{*}{avx2}
        & 128\,B        & 138
                        & 142
                        & 2.90
                        & 182
                        & 28.17
                        & 180
                        & -1.10
                        & 30.43 \\

 &      & 128\,B verif  & 142
                        & 146
                        & 2.82
                        & 180
                        & 23.29
                        & 178
                        & -1.11
                        & 25.35 \\

 &      & 1\,KiB        & 670
                        & 672
                        & 0.30
                        & 720
                        & 7.14
                        & 718
                        & -0.28
                        & 7.16 \\

 &      & 1\,KiB verif  & 674
                        & 676
                        & 0.30
                        & 726
                        & 7.40
                        & 724
                        & -0.28
                        & 7.42 \\

 &      & 16\,KiB       & 8942
                        & 8948
                        & 0.07
                        & 8990
                        & 0.47
                        & 8986
                        & -0.04
                        & 0.49 \\

 &      & 16\,KiB verif & 8942
                        & 8948
                        & 0.07
                        & 8984
                        & 0.40
                        & 8984
                        & 0.00
                        & 0.47 \\

      \midrule
    \multirow{8}{*}{XSalsa20Poly1305}
 &  \multirow{6}{*}{avx2}
        & 128\,B        & 1206
                        & 1212
                        & 0.50
                        & 1250
                        & 3.14
                        & 1246
                        & -0.32
                        & 3.32 \\

 &      & 128\,B open   & 1964
                        & 1970
                        & 0.31
                        & 2044
                        & 3.76
                        & 2046
                        & 0.10
                        & 4.18 \\

 &      & 1\,KiB        & 3140
                        & 3142
                        & 0.06
                        & 3190
                        & 1.53
                        & 3188
                        & -0.06
                        & 1.53 \\

 &      & 1\,KiB open   & 3900
                        & 3904
                        & 0.10
                        & 3988
                        & 2.15
                        & 3988
                        & 0.00
                        & 2.26 \\

 &      & 16\,KiB       & 32598
                        & 32574
                        & -0.07
                        & 32604
                        & 0.09
                        & 32602
                        & -0.01
                        & 0.01 \\

 &      & 16\,KiB open  & 33292
                        & 33274
                        & -0.05
                        & 33358
                        & 0.25
                        & 33362
                        & 0.01
                        & 0.21 \\

      \midrule
    \multirow{4}{*}{SHAKE256}
 &  \multirow{4}{*}{avx2}
        &  128\,B \textleftarrow\, 128\,B
                        & 1206
                        & 1324
                        & 9.78
                        & 1390
                        & 4.98
                        & 1390
                        & 0.00
                        & 15.26 \\

 &      &  256\,B \textleftarrow\, 128\,B
                        & 2334
                        & 2450
                        & 4.97
                        & 2534
                        & 3.43
                        & 2546
                        & 0.47
                        & 9.08 \\


 &      &  512\,B \textleftarrow\, 128\,B
                        & 4588
                        & 4700
                        & 2.44
                        & 4796
                        & 2.04
                        & 4826
                        & 0.63
                        & 5.19 \\


 &      &  1\,KiB \textleftarrow\, 128\,B
                        & 9102
                        & 9216
                        & 1.25
                        & 9400
                        & 2.00
                        & 9384
                        & -0.17
                        & 3.10 \\

      \midrule
    \multirow{1}{*}{X25519}
 & mulx & smult         & 102848
                        & 104150
                        & 1.27
                        & 104424
                        & 0.26
                        & 104428
                        & 0.00
                        & 1.54 \\

      \midrule
    \multirow{3}{*}{Kyber512}
 &  \multirow{3}{*}{avx2}
        & keypair       & 27676
                        & 28106
                        & 1.55
                        & 28040
                        & -0.23
                        & 28090
                        & 0.18
                        & 1.50 \\

 &      & enc           & 37050
                        & 38332
                        & 3.46
                        & 38876
                        & 1.42
                        & 38792
                        & -0.22
                        & 4.70 \\

 &      & dec           & 29302
                        & 30444
                        & 3.90
                        & 30590
                        & 0.48
                        & 30714
                        & 0.41
                        & 4.82 \\

      \midrule
    \multirow{3}{*}{Kyber768}
 &  \multirow{3}{*}{avx2}
        & keypair       & 43432
                        & 45708
                        & 5.24
                        & 45860
                        & 0.33

                        & 46548
                        & 1.50
                        & 7.17 \\

 &      & enc           & 57006
                        & 59316
                        & 4.05
                        & 60028
                        & 1.20
                        & 60674
                        & 1.08
                        & 6.43 \\

 &      & dec           & 46138
                        & 48418
                        & 4.94
                        & 48532
                        & 0.24
                        & 49294
                        & 1.57
                        & 6.84 \\
  \bottomrule
  \end{tabular}
\end{table}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% reference implementations
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\setlength{\tabcolsep}{4pt}
\begin{table}[H]
    \caption{Performance: 11700K - ref implementations.}
    \label{tab:results:all:11700K:ref}
  \begin{tabular}{lllrrrrr}
  \toprule
    Primitive
 & Impl. & Op.          & plain & +SSBD & +SSBD+v1 & +SSBD+v1+RSB & increase \% \\

    \multirow{6}{*}{ChaCha20}
 &  \multirow{6}{*}{ref}
       & 128\,B         & 768
                        & 794
                        & 822
                        & 820
                        & 6.77 \\

 &     & 128\,B xor     & 774
                        & 798
                        & 826
                        & 824
                        & 6.46 \\

 &     & 1\,KiB         & 5932
                        & 6098
                        & 6140
                        & 6130
                        & 3.34 \\

 &     & 1\,KiB xor     & 5984
                        & 6148
                        & 6190
                        & 6176
                        & 3.21 \\

 &     & 16\,KiB        & 94420
                        & 96926
                        & 97220
                        & 97228
                        & 2.97 \\

 &     & 16\,KiB xor    & 95218
                        & 97708
                        & 98066
                        & 98010
                        & 2.93 \\

     \midrule
    \multirow{6}{*}{Poly1305}
 &  \multirow{6}{*}{ref}
       & 128\,B         & 138
                        & 142
                        & 180
                        & 178
                        & 28.99 \\

 &     & 128\,B verif   & 142
                        & 144
                        & 186
                        & 188
                        & 32.39 \\

 &     & 1\,KiB         & 1126
                        & 1130
                        & 1154
                        & 1154
                        & 2.49 \\

 &     & 1\,KiB verif   & 1120
                        & 1126
                        & 1158
                        & 1156
                        & 3.21 \\

 &     & 16\,KiB        & 17542
                        & 17548
                        & 17568
                        & 17570
                        & 0.16 \\

 &     & 16\,KiB verif  & 17542
                        & 17580
                        & 17580
                        & 17574
                        & 0.18 \\

      \midrule
    \multirow{6}{*}{XSalsa20Poly1305}
 &  \multirow{6}{*}{ref}
       & 128\,B         & 1626
                        & 1648
                        & 1680
                        & 1678
                        & 3.20 \\

 &     & 128\,B open    & 2384
                        & 2410
                        & 2478
                        & 2478
                        & 3.94 \\

 &     & 1\,KiB         & 7860
                        & 7916
                        & 7926
                        & 7926
                        & 0.84 \\

 &     & 1\,KiB open    & 8596
                        & 8666
                        & 8718
                        & 8720
                        & 1.44 \\

 &     & 16\,KiB        & 113852
                        & 114990
                        & 114892
                        & 114880
                        & 0.90 \\

 &     & 16\,KiB open   & 114662
                        & 115934
                        & 115758
                        & 115760
                        & 0.96 \\

      \midrule
    \multirow{4}{*}{SHAKE256}
 &  \multirow{4}{*}{ref}
        &  128\,B \textleftarrow\, 128\,B
                        & 1176
                        & 1226
                        & 1242
                        & 1230
                        & 4.59 \\

 &      &  256\,B \textleftarrow\, 128\,B
                        & 2274
                        & 2368
                        & 2386
                        & 2370
                        & 4.22 \\


 &      &  512\,B \textleftarrow\, 128\,B
                        & 4454
                        & 4654
                        & 4670
                        & 4746
                        & 6.56 \\


 &      &  1\,KiB \textleftarrow\, 128\,B
                        & 8824
                        & 9214
                        & 9238
                        & 9284
                        & 5.21 \\

      \midrule
    \multirow{1}{*}{X25519}
 & ref4 & smult         & 121300
                        & 125798
                        & 126252
                        & 126286
                        & 4.11 \\

  \bottomrule
  \end{tabular}
\end{table}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%  reference implementations - step by step overhead
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\setlength{\tabcolsep}{3pt}
\begin{table}[H]
    \caption{Performance: 11700K - ref implementations - step by step overhead.}
    \label{tab:results:all:step:11700K:ref}
  \begin{tabular}{lllrrrrrrrr}
  \toprule
    Primitive
 & Impl. & Op.          & plain & +SSBD & \% & +SSBD+v1 & \% & +SSBD+v1+RSB & \% & increase \% \\

    \multirow{6}{*}{ChaCha20}
 &  \multirow{6}{*}{avx2}
        & 128\,B        & 768
                        & 794
                        & 3.39
                        & 822
                        & 3.53
                        & 820
                        & -0.24
                        & 6.77 \\

 &      & 128\,B xor    & 774
                        & 798
                        & 3.10
                        & 826
                        & 3.51
                        & 824
                        & -0.24
                        & 6.46 \\

 &      & 1\,KiB        & 5932
                        & 6098
                        & 2.80
                        & 6140
                        & 0.69
                        & 6130
                        & -0.16
                        & 3.34 \\

 &      & 1\,KiB xor    & 5984
                        & 6148
                        & 2.74
                        & 6190
                        & 0.68
                        & 6176
                        & -0.23
                        & 3.21 \\

 &      & 16\,KiB       & 94420
                        & 96926
                        & 2.65
                        & 97220
                        & 0.30
                        & 97228
                        & 0.01
                        & 2.97 \\

 &      & 16\,KiB xor   & 95218
                        & 97708
                        & 2.62
                        & 98066
                        & 0.37
                        & 98010
                        & -0.06
                        & 2.93 \\

     \midrule
    \multirow{6}{*}{Poly1305}
 &  \multirow{6}{*}{avx2}
        & 128\,B        & 138
                        & 142
                        & 2.90
                        & 180
                        & 26.76
                        & 178
                        & -1.11
                        & 28.99 \\

 &      & 128\,B verif  & 142
                        & 144
                        & 1.41
                        & 186
                        & 29.17
                        & 188
                        & 1.08
                        & 32.39 \\

 &      & 1\,KiB        & 1126
                        & 1130
                        & 0.36
                        & 1154
                        & 2.12
                        & 1154
                        & 0.00
                        & 2.49 \\

 &      & 1\,KiB verif  & 1120
                        & 1126
                        & 0.54
                        & 1158
                        & 2.84
                        & 1156
                        & -0.17
                        & 3.21 \\

 &      & 16\,KiB       & 17542
                        & 17548
                        & 0.03
                        & 17568
                        & 0.11
                        & 17570
                        & 0.01
                        & 0.16 \\

 &      & 16\,KiB verif & 17542
                        & 17548
                        & 0.03
                        & 17580
                        & 0.18
                        & 17574
                        & -0.03
                        & 0.18 \\

      \midrule
    \multirow{8}{*}{XSalsa20Poly1305}
 &  \multirow{6}{*}{avx2}
        & 128\,B        & 1626
                        & 1648
                        & 1.35
                        & 1680
                        & 1.94
                        & 1678
                        & -0.12
                        & 3.20 \\

 &      & 128\,B open   & 2384
                        & 2410
                        & 1.09
                        & 2478
                        & 2.82
                        & 2478
                        & 0.00
                        & 3.94 \\

 &      & 1\,KiB        & 7860
                        & 7916
                        & 0.71
                        & 7926
                        & 0.13
                        & 7926
                        & 0.00
                        & 0.84 \\

 &      & 1\,KiB open   & 8596
                        & 8666
                        & 0.81
                        & 8718
                        & 0.60
                        & 8720
                        & 0.02
                        & 1.44 \\

 &      & 16\,KiB       & 113852
                        & 114990
                        & 1.00
                        & 114892
                        & -0.09
                        & 114880
                        & -0.01
                        & 0.90 \\

 &      & 16\,KiB open  & 114662
                        & 115934
                        & 1.11
                        & 115758
                        & -0.15
                        & 115760
                        & 0.00
                        & 0.96 \\

      \midrule
    \multirow{4}{*}{SHAKE256}
 &  \multirow{4}{*}{avx2}
        &  128\,B \textleftarrow\, 128\,B
                        & 1176
                        & 1226
                        & 4.25
                        & 1242
                        & 1.31
                        & 1230
                        & -0.97
                        & 4.59 \\

 &      &  256\,B \textleftarrow\, 128\,B
                        & 2274
                        & 2368
                        & 4.13
                        & 2386
                        & 0.76
                        & 2370
                        & -0.67
                        & 4.22 \\


 &      &  512\,B \textleftarrow\, 128\,B
                        & 4454
                        & 4654
                        & 4.49
                        & 4670
                        & 0.34
                        & 4746
                        & 1.63
                        & 6.56 \\


 &      &  1\,KiB \textleftarrow\, 128\,B
                        & 8824
                        & 9214
                        & 4.42
                        & 9238
                        & 0.26
                        & 9284
                        & 0.50
                        & 5.21 \\

      \midrule
    \multirow{1}{*}{X25519}
 & mulx & smult         & 121300
                        & 125798
                        & 3.71
                        & 126252
                        & 0.36
                        & 126286
                        & 0.03
                        & 4.11 \\
  \bottomrule
  \end{tabular}
\end{table}


